<VirtualHost *:80>
    ServerName localhost
    ServerAdmin webmaster@localhost

    # HTTPからHTTPSへリダイレクト (ポート{{HTTPS_PORT}})
    RewriteEngine On
    RewriteCond %{HTTPS} off
    RewriteCond %{HTTP_HOST} ^localhost
    RewriteRule ^(.*)$ https://localhost:{{HTTPS_PORT}}%{REQUEST_URI} [R=301,L]

    # その他のホスト名の場合
    RewriteCond %{HTTPS} off
    RewriteCond %{HTTP_HOST} !^localhost
    RewriteRule ^(.*)$ https://%{HTTP_HOST}%{REQUEST_URI} [R=301,L]
</VirtualHost>
